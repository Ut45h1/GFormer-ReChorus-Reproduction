INFO:root:Namespace(model_name='GFormer', model_mode='')
INFO:root:--------------------------------------------- BEGIN: 2025-12-30 17:45:02 ---------------------------------------------
INFO:root:
===============================================
 Arguments              | Values               
===============================================
 batch_size             | 256                 
 data_appendix          |                     
 dataset                | Grocery_and_Gourm...
 dropout                | 0                   
 early_stop             | 10                  
 emb_size               | 64                  
 epoch                  | 200                 
 eval_batch_size        | 128                 
 gpu                    | 0                   
 l2                     | 0.0001              
 lambda1                | 1.0                 
 lambda2                | 0.001               
 lr                     | 0.001               
 main_metric            |                     
 n_anchors              | 32                  
 n_heads                | 2                   
 n_layers               | 2                   
 num_layers_transformer | 1                   
 num_neg                | 1                   
 num_workers            | 0                   
 optimizer              | Adam                
 random_seed            | 0                   
 save_final_results     | 1                   
 test_all               | 1                   
 topk                   | 5,10,20,50          
===============================================
INFO:root:Device: cuda
INFO:root:Load corpus from ../data/Grocery_and_Gourmet_Food/BaseReader.pkl
INFO:root:#params: 1541120
INFO:root:GFormer(
  (transformer_encoder): TransformerEncoder(
    (layers): ModuleList(
      (0): TransformerEncoderLayer(
        (self_attn): MultiheadAttention(
          (out_proj): NonDynamicallyQuantizableLinear(in_features=64, out_features=64, bias=True)
        )
        (linear1): Linear(in_features=64, out_features=128, bias=True)
        (dropout): Dropout(p=0.1, inplace=False)
        (linear2): Linear(in_features=128, out_features=64, bias=True)
        (norm1): LayerNorm((64,), eps=1e-05, elementwise_affine=True)
        (norm2): LayerNorm((64,), eps=1e-05, elementwise_affine=True)
        (dropout1): Dropout(p=0.1, inplace=False)
        (dropout2): Dropout(p=0.1, inplace=False)
      )
    )
  )
  (fusion_gate): Linear(in_features=128, out_features=64, bias=True)
)
INFO:root:Test Before Training: (HR@5:0.0003,NDCG@5:0.0003,HR@10:0.0010,NDCG@10:0.0005,HR@20:0.0018,NDCG@20:0.0007,HR@50:0.0055,NDCG@50:0.0014)
INFO:root:Optimizer: Adam
INFO:root:Epoch 1     loss=0.2832 [93.8 s]	dev=(HR@5:0.0122,NDCG@5:0.0076) [7.0 s] *
INFO:root:Epoch 2     loss=0.1477 [92.6 s]	dev=(HR@5:0.0122,NDCG@5:0.0080) [7.0 s] *
INFO:root:Epoch 3     loss=0.1148 [92.6 s]	dev=(HR@5:0.0148,NDCG@5:0.0093) [7.0 s] *
INFO:root:Epoch 4     loss=0.0944 [92.8 s]	dev=(HR@5:0.0187,NDCG@5:0.0116) [7.0 s] *
INFO:root:Epoch 5     loss=0.0851 [92.6 s]	dev=(HR@5:0.0158,NDCG@5:0.0099) [7.2 s]
INFO:root:Epoch 6     loss=0.0809 [92.3 s]	dev=(HR@5:0.0178,NDCG@5:0.0110) [7.4 s]
INFO:root:Epoch 7     loss=0.0776 [92.1 s]	dev=(HR@5:0.0199,NDCG@5:0.0125) [5.9 s] *
INFO:root:Epoch 8     loss=0.0755 [94.2 s]	dev=(HR@5:0.0202,NDCG@5:0.0131) [5.8 s] *
INFO:root:Epoch 9     loss=0.0753 [93.8 s]	dev=(HR@5:0.0205,NDCG@5:0.0131) [5.8 s]
INFO:root:Epoch 10    loss=0.0749 [93.7 s]	dev=(HR@5:0.0208,NDCG@5:0.0134) [5.8 s] *
INFO:root:Epoch 11    loss=0.0752 [94.0 s]	dev=(HR@5:0.0195,NDCG@5:0.0125) [5.8 s]
INFO:root:Epoch 12    loss=0.0747 [93.9 s]	dev=(HR@5:0.0204,NDCG@5:0.0129) [5.8 s]
INFO:root:Epoch 13    loss=0.0747 [93.9 s]	dev=(HR@5:0.0221,NDCG@5:0.0140) [5.8 s] *
INFO:root:Epoch 14    loss=0.0751 [93.7 s]	dev=(HR@5:0.0214,NDCG@5:0.0135) [5.8 s]
INFO:root:Epoch 15    loss=0.0741 [94.4 s]	dev=(HR@5:0.0194,NDCG@5:0.0123) [5.6 s]
INFO:root:Epoch 16    loss=0.0742 [94.1 s]	dev=(HR@5:0.0230,NDCG@5:0.0149) [5.8 s] *
INFO:root:Epoch 17    loss=0.0738 [93.9 s]	dev=(HR@5:0.0231,NDCG@5:0.0148) [5.8 s]
INFO:root:Early stop manually
INFO:root:
--------------------------------------------- END: 2025-12-30 18:14:22 ---------------------------------------------
INFO:root:Namespace(model_name='GFormer', model_mode='')
INFO:root:--------------------------------------------- BEGIN: 2025-12-31 00:39:40 ---------------------------------------------
INFO:root:
===============================================
 Arguments              | Values               
===============================================
 batch_size             | 256                 
 data_appendix          |                     
 dataset                | Grocery_and_Gourm...
 dropout                | 0                   
 early_stop             | 10                  
 emb_size               | 64                  
 epoch                  | 200                 
 eval_batch_size        | 256                 
 gpu                    | 0                   
 l2                     | 0.0001              
 lambda1                | 1.0                 
 lambda2                | 0.001               
 lr                     | 0.001               
 main_metric            |                     
 n_anchors              | 32                  
 n_heads                | 2                   
 n_layers               | 2                   
 num_layers_transformer | 1                   
 num_neg                | 1                   
 num_workers            | 4                   
 optimizer              | Adam                
 random_seed            | 0                   
 save_final_results     | 1                   
 test_all               | 1                   
 topk                   | 5,10,20,50          
===============================================
INFO:root:Device: cuda
INFO:root:Load corpus from ../data/Grocery_and_Gourmet_Food/BaseReader.pkl
INFO:root:#params: 1541120
INFO:root:GFormer(
  (transformer_encoder): TransformerEncoder(
    (layers): ModuleList(
      (0): TransformerEncoderLayer(
        (self_attn): MultiheadAttention(
          (out_proj): NonDynamicallyQuantizableLinear(in_features=64, out_features=64, bias=True)
        )
        (linear1): Linear(in_features=64, out_features=128, bias=True)
        (dropout): Dropout(p=0.1, inplace=False)
        (linear2): Linear(in_features=128, out_features=64, bias=True)
        (norm1): LayerNorm((64,), eps=1e-05, elementwise_affine=True)
        (norm2): LayerNorm((64,), eps=1e-05, elementwise_affine=True)
        (dropout1): Dropout(p=0.1, inplace=False)
        (dropout2): Dropout(p=0.1, inplace=False)
      )
    )
  )
  (fusion_gate): Linear(in_features=128, out_features=64, bias=True)
)
INFO:root:Test Before Training: (HR@5:0.0003,NDCG@5:0.0003,HR@10:0.0010,NDCG@10:0.0005,HR@20:0.0018,NDCG@20:0.0007,HR@50:0.0055,NDCG@50:0.0014)
INFO:root:Optimizer: Adam
INFO:root:Epoch 1     loss=0.2832 [95.6 s]	dev=(HR@5:0.0124,NDCG@5:0.0080) [3.8 s] *
INFO:root:Epoch 2     loss=0.1477 [93.8 s]	dev=(HR@5:0.0132,NDCG@5:0.0086) [3.5 s] *
INFO:root:Epoch 3     loss=0.1138 [93.4 s]	dev=(HR@5:0.0148,NDCG@5:0.0096) [5.5 s] *
INFO:root:Epoch 4     loss=0.0932 [92.6 s]	dev=(HR@5:0.0188,NDCG@5:0.0117) [3.7 s] *
INFO:root:Epoch 5     loss=0.0847 [95.5 s]	dev=(HR@5:0.0172,NDCG@5:0.0105) [3.6 s]
INFO:root:Epoch 6     loss=0.0804 [94.5 s]	dev=(HR@5:0.0181,NDCG@5:0.0115) [3.9 s]
INFO:root:Epoch 7     loss=0.0778 [93.4 s]	dev=(HR@5:0.0188,NDCG@5:0.0117) [3.9 s] *
INFO:root:Epoch 8     loss=0.0760 [95.7 s]	dev=(HR@5:0.0194,NDCG@5:0.0118) [3.8 s] *
INFO:root:Epoch 9     loss=0.0756 [94.6 s]	dev=(HR@5:0.0185,NDCG@5:0.0120) [3.8 s] *
INFO:root:Epoch 10    loss=0.0758 [96.6 s]	dev=(HR@5:0.0194,NDCG@5:0.0122) [4.2 s] *
INFO:root:Epoch 11    loss=0.0753 [92.7 s]	dev=(HR@5:0.0187,NDCG@5:0.0118) [5.3 s]
INFO:root:Epoch 12    loss=0.0746 [92.7 s]	dev=(HR@5:0.0200,NDCG@5:0.0123) [3.6 s] *
INFO:root:Epoch 13    loss=0.0749 [94.7 s]	dev=(HR@5:0.0200,NDCG@5:0.0129) [4.0 s] *
INFO:root:Epoch 14    loss=0.0739 [93.8 s]	dev=(HR@5:0.0196,NDCG@5:0.0126) [3.7 s]
INFO:root:Epoch 15    loss=0.0739 [94.8 s]	dev=(HR@5:0.0203,NDCG@5:0.0126) [3.7 s]
INFO:root:Epoch 16    loss=0.0742 [94.1 s]	dev=(HR@5:0.0210,NDCG@5:0.0130) [3.8 s] *
INFO:root:Epoch 17    loss=0.0736 [95.3 s]	dev=(HR@5:0.0200,NDCG@5:0.0126) [3.7 s]
INFO:root:Epoch 18    loss=0.0748 [94.1 s]	dev=(HR@5:0.0193,NDCG@5:0.0121) [3.7 s]
INFO:root:Epoch 19    loss=0.0745 [94.4 s]	dev=(HR@5:0.0218,NDCG@5:0.0136) [3.7 s] *
INFO:root:Epoch 20    loss=0.0734 [96.2 s]	dev=(HR@5:0.0217,NDCG@5:0.0141) [3.5 s] *
INFO:root:Epoch 21    loss=0.0734 [94.6 s]	dev=(HR@5:0.0223,NDCG@5:0.0139) [3.6 s]
INFO:root:Epoch 22    loss=0.0725 [94.1 s]	dev=(HR@5:0.0209,NDCG@5:0.0131) [3.8 s]
INFO:root:Epoch 23    loss=0.0729 [96.0 s]	dev=(HR@5:0.0219,NDCG@5:0.0143) [3.8 s] *
INFO:root:Epoch 24    loss=0.0727 [94.4 s]	dev=(HR@5:0.0224,NDCG@5:0.0148) [3.5 s] *
INFO:root:Epoch 25    loss=0.0731 [94.1 s]	dev=(HR@5:0.0189,NDCG@5:0.0120) [3.5 s]
INFO:root:Epoch 26    loss=0.0728 [95.7 s]	dev=(HR@5:0.0216,NDCG@5:0.0135) [3.5 s]
INFO:root:Epoch 27    loss=0.0725 [93.5 s]	dev=(HR@5:0.0233,NDCG@5:0.0146) [3.8 s]
INFO:root:Epoch 28    loss=0.0732 [95.5 s]	dev=(HR@5:0.0232,NDCG@5:0.0148) [3.8 s]
INFO:root:Epoch 29    loss=0.0727 [94.8 s]	dev=(HR@5:0.0233,NDCG@5:0.0148) [3.8 s]
INFO:root:Epoch 30    loss=0.0721 [95.0 s]	dev=(HR@5:0.0219,NDCG@5:0.0136) [3.9 s]
INFO:root:Epoch 31    loss=0.0720 [94.1 s]	dev=(HR@5:0.0234,NDCG@5:0.0150) [5.3 s] *
INFO:root:Epoch 32    loss=0.0724 [94.7 s]	dev=(HR@5:0.0245,NDCG@5:0.0159) [3.9 s] *
INFO:root:Epoch 33    loss=0.0726 [98.2 s]	dev=(HR@5:0.0243,NDCG@5:0.0155) [3.6 s]
INFO:root:Epoch 34    loss=0.0719 [97.6 s]	dev=(HR@5:0.0221,NDCG@5:0.0145) [3.9 s]
INFO:root:Epoch 35    loss=0.0721 [96.8 s]	dev=(HR@5:0.0213,NDCG@5:0.0130) [3.9 s]
INFO:root:Epoch 36    loss=0.0720 [97.0 s]	dev=(HR@5:0.0217,NDCG@5:0.0138) [3.9 s]
INFO:root:Epoch 37    loss=0.0724 [97.5 s]	dev=(HR@5:0.0240,NDCG@5:0.0161) [3.9 s] *
INFO:root:Epoch 38    loss=0.0731 [97.9 s]	dev=(HR@5:0.0231,NDCG@5:0.0149) [3.6 s]
INFO:root:Epoch 39    loss=0.0725 [96.1 s]	dev=(HR@5:0.0225,NDCG@5:0.0147) [3.9 s]
INFO:root:Epoch 40    loss=0.0720 [97.5 s]	dev=(HR@5:0.0202,NDCG@5:0.0129) [3.8 s]
INFO:root:Epoch 41    loss=0.0715 [96.2 s]	dev=(HR@5:0.0234,NDCG@5:0.0150) [3.8 s]
INFO:root:Epoch 42    loss=0.0726 [96.6 s]	dev=(HR@5:0.0209,NDCG@5:0.0130) [3.7 s]
INFO:root:Epoch 43    loss=0.0721 [96.5 s]	dev=(HR@5:0.0213,NDCG@5:0.0135) [3.8 s]
INFO:root:Epoch 44    loss=0.0721 [96.9 s]	dev=(HR@5:0.0224,NDCG@5:0.0140) [3.7 s]
INFO:root:Epoch 45    loss=0.0714 [96.3 s]	dev=(HR@5:0.0220,NDCG@5:0.0140) [3.7 s]
INFO:root:Epoch 46    loss=0.0727 [96.1 s]	dev=(HR@5:0.0226,NDCG@5:0.0143) [3.7 s]
INFO:root:Early stop at 46 based on dev result.
INFO:root:
Best Iter(dev)=   37	 dev=(HR@5:0.0240,NDCG@5:0.0161) [4560.9 s] 
INFO:root:Load model from ../model/GFormer/GFormer__Grocery_and_Gourmet_Food__0__lr=0.001__l2=0.0001__emb_size=64__n_layers=2__batch_size=256.pt
INFO:root:
Dev  After Training: (HR@5:0.0240,NDCG@5:0.0161,HR@10:0.0372,NDCG@10:0.0203,HR@20:0.0589,NDCG@20:0.0258,HR@50:0.1041,NDCG@50:0.0347)
INFO:root:
Test After Training: (HR@5:0.0148,NDCG@5:0.0098,HR@10:0.0246,NDCG@10:0.0129,HR@20:0.0411,NDCG@20:0.0171,HR@50:0.0753,NDCG@50:0.0238)
INFO:root:Saving top-100 recommendation results to: ../log/GFormer/GFormer__Grocery_and_Gourmet_Food__0__lr=0/rec-GFormer-dev.csv
INFO:root:dev Prediction results saved!
INFO:root:Saving top-100 recommendation results to: ../log/GFormer/GFormer__Grocery_and_Gourmet_Food__0__lr=0/rec-GFormer-test.csv
INFO:root:test Prediction results saved!
INFO:root:
--------------------------------------------- END: 2025-12-31 01:57:26 ---------------------------------------------
